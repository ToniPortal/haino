"use strict";const e=require("fs"),r=require("path"),{ipcRenderer:s}=require("electron"),{findClosestMatch:n}=require("../../../shared/closest");exports.run=(o,t,c)=>{const i=r.join(process.env.USERPROFILE||process.env.HOME,"Desktop"),a=r.join(process.env.USERPROFILE||process.env.HOME,"Links"),p=r.join(process.env.ProgramData,"Microsoft","Windows","Start Menu","Programs"),u=r.join(process.env.APPDATA,"Microsoft","Internet Explorer","Quick Launch","User Pinned","TaskBar"),l=r.join(process.env.APPDATA,"Microsoft","Windows","Start Menu"),d=[];[i,a,p,u,l].forEach((s=>{try{e.readdirSync(s).forEach((e=>{e.endsWith(".lnk")&&d.push(r.join(s,e))}))}catch(e){console.error(`Erreur lors de la lecture du r√©pertoire ${s} : ${e}`)}}));const E=o.trim().split(" ").slice(1).join(" "),h=n(E,d);t.innerText=r.basename(h).replace(".lnk",""),"Enter"===c&&s.send("url",`${h}`)};
